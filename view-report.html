<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Report Detail</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @media print {
            .no-print {
                display: none !important;
            }

            body {
                padding: 0;
            }

            .print-box {
                border: none !important;
                box-shadow: none !important;
            }
        }
    </style>
</head>

<body class="bg-slate-50 p-4 md:p-10">
    <div class="max-w-4xl mx-auto bg-white p-8 md:p-16 border rounded-2xl shadow-xl print-box">
        <div class="flex justify-between items-end border-b-8 border-blue-900 pb-6 mb-10">
            <div>
                <h1 id="vProgram" class="text-4xl font-black text-slate-900 leading-none">...</h1>
                <p id="vUnit" class="text-blue-600 font-black uppercase tracking-widest mt-3"></p>
            </div>
            <div class="text-right">
                <p id="vDate" class="text-lg font-bold text-slate-800"></p>
                <p id="vName" class="text-xs text-slate-400 uppercase italic"></p>
            </div>
        </div>

        <div class="space-y-12">
            <section>
                <h2
                    class="text-xs font-black text-blue-900 uppercase tracking-tighter mb-3 border-l-4 border-blue-900 pl-3">
                    Program Objective</h2>
                <p id="vObjective" class="text-xl text-slate-700 leading-relaxed font-serif italic"></p>
            </section>

            <section>
                <h2
                    class="text-xs font-black text-blue-900 uppercase tracking-tighter mb-3 border-l-4 border-blue-900 pl-3">
                    Documentation Details</h2>
                <div id="vFull"
                    class="text-slate-700 leading-relaxed whitespace-pre-wrap text-lg bg-slate-50 p-6 rounded-2xl">
                </div>
            </section>

            <section>
                <h2
                    class="text-xs font-black text-blue-900 uppercase tracking-tighter mb-6 border-l-4 border-blue-900 pl-3">
                    Visual Evidence</h2>
                <div id="vGallery" class="grid grid-cols-1 md:grid-cols-2 gap-8"></div>
            </section>
        </div>

        <div class="mt-16 pt-10 border-t no-print flex gap-6">
            <button onclick="window.print()"
                class="bg-blue-900 text-white px-10 py-4 rounded-2xl font-black shadow-xl hover:scale-105 transition">DOWNLOAD
                AS PDF</button>
            <button onclick="window.location.href='dashboard.html'"
                class="bg-gray-100 text-gray-500 px-10 py-4 rounded-2xl font-bold">EXIT</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCR9EPwlakRDXN1v6Rm19ro7XvowvBnY2k",
            authDomain: "jpns-ereport.firebaseapp.com",
            projectId: "jpns-ereport",
            storageBucket: "jpns-ereport.firebasestorage.app",
            messagingSenderId: "928703430086",
            appId: "1:928703430086:web:273fc8a67f22ce1b9e86c7"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const id = new URLSearchParams(window.location.search).get('id');
        if (id) {
            const snap = await getDoc(doc(db, "reports", id));
            if (snap.exists()) {
                const d = snap.data();
                document.getElementById('vProgram').innerText = d.program;
                document.getElementById('vUnit').innerText = d.unit;
                document.getElementById('vDate').innerText = d.date;
                document.getElementById('vName').innerText = "Submitted By: " + d.name;
                document.getElementById('vObjective').innerText = d.objective || "N/A";
                document.getElementById('vFull').innerText = d.fullReport || "No details provided.";

                const gallery = document.getElementById('vGallery');
                (d.imageUrls || []).forEach(url => {
                    gallery.innerHTML += `<img src="${url}" class="w-full rounded-3xl shadow-lg border-8 border-white">`;
                });
            }
        }
    </script>
</body>

</html>